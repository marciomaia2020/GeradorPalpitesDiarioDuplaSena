<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Jogos da Dupla Sena - Personalizado</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        :root {
            --primary-color: #ba184a; /* Rosa/Vermelho (Dupla Sena) */
            --primary-dark: #9e1540;
            --secondary-color: #e5346c;
            --accent-color: #cb1a52;
            --background-color: #fce8ef;
            --table-header: #ba184a;
            --table-border: #e5346c;
            --table-even: #f9d2de;
            --table-odd: #ffffff;
            --text-color: #2d0612;
            --footer-color: #5a0c25;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        .header {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .logo {
            width: 350px;
            height: auto;
            margin-bottom: 15px;
        }

        h1 {
            text-align: center;
            color: var(--primary-dark);
            margin: 10px 0;
            font-size: 2.2rem;
            font-weight: 700;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        .container {
            max-width: 1200px;
            width: 100%;
            padding: 20px;
            margin-bottom: 40px;
        }

        .centralizado {
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.2rem;
            color: var(--primary-dark);
        }

        /* Se√ß√£o dos √öltimos Resultados */
        .latest-results-section {
            background: linear-gradient(135deg, #fce8ef, #f9d2de);
            border: 2px solid #ba184a;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 16px rgba(186, 24, 74, 0.3);
        }

        .latest-results-title {
            color: #ba184a;
            font-size: 1.3rem;
            font-weight: bold;
            text-align: center;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
        }

        .result-card {
            background: white;
            border: 2px solid #e5346c;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }

        .result-card.destaque {
            border: 3px solid #ba184a;
            box-shadow: 0 4px 12px rgba(186, 24, 74, 0.4);
        }

        .result-header {
            color: var(--primary-dark);
            font-weight: bold;
            margin-bottom: 10px;
        }

        .result-date {
            color: #5a0c25;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .result-numbers {
            margin: 10px 0;
        }

        .dezena-resultado {
            display: inline-block;
            width: 35px;
            height: 35px;
            line-height: 35px;
            text-align: center;
            background-color: var(--primary-color);
            color: white;
            border-radius: 50%;
            margin: 0 3px;
            font-size: 0.9rem;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(186, 24, 74, 0.3);
        }

        .sorteio-label {
            background-color: var(--accent-color);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-weight: bold;
            margin: 5px 0;
            display: inline-block;
            font-size: 0.8rem;
        }

        .use-result-btn {
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            margin-top: 10px;
            transition: all 0.3s ease;
        }

        .use-result-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(186, 24, 74, 0.3);
        }

        /* Grid de Sele√ß√£o de N√∫meros */
        .number-selection-section {
            background: linear-gradient(135deg, #fce8ef, #f9d2de);
            border: 2px solid #ba184a;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 16px rgba(186, 24, 74, 0.3);
        }

        .selection-title {
            color: #ba184a;
            font-size: 1.3rem;
            font-weight: bold;
            text-align: center;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .selection-info {
            text-align: center;
            margin-bottom: 20px;
            color: var(--primary-dark);
        }

        .numbers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(50px, 1fr));
            gap: 8px;
            max-width: 800px;
            margin: 0 auto 20px;
        }

        .number-btn {
            width: 50px;
            height: 50px;
            border: 2px solid #e5346c;
            background: white;
            color: var(--text-color);
            border-radius: 50%;
            cursor: pointer;
            font-weight: bold;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .number-btn:hover {
            border-color: var(--primary-color);
            transform: scale(1.1);
        }

        .number-btn.selected {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-dark);
            transform: scale(1.1);
        }

        .number-btn.last-result {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            border: 3px solid #a93226;
            animation: pulse 2s infinite;
        }

        .number-btn.last-result.selected {
            background: linear-gradient(135deg, #8e44ad, #7d3c98);
            border: 3px solid #6c3483;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(231, 76, 60, 0); }
            100% { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0); }
        }

        .selection-controls {
            text-align: center;
            margin-top: 20px;
        }

        .selection-controls .button {
            margin: 0 10px;
        }

        /* Configura√ß√µes de Gera√ß√£o */
        .generation-section {
            background: linear-gradient(135deg, #fce8ef, #f9d2de);
            border: 2px solid #ba184a;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 16px rgba(186, 24, 74, 0.3);
        }

        .generation-title {
            color: #ba184a;
            font-size: 1.3rem;
            font-weight: bold;
            text-align: center;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .config-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .config-item {
            background: white;
            border: 2px solid #e5346c;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .config-item label {
            display: block;
            color: #5a0c25;
            font-size: 1rem;
            font-weight: bold;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .config-item input,
        .config-item select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e5346c;
            border-radius: 6px;
            font-size: 1.1rem;
            font-weight: bold;
            text-align: center;
            background: #fce8ef;
            color: #5a0c25;
        }

        .config-item input:focus,
        .config-item select:focus {
            outline: none;
            border-color: #ba184a;
            box-shadow: 0 0 0 3px rgba(186, 24, 74, 0.2);
        }

        /* Jogos Gerados */
        .games-section {
            background: linear-gradient(135deg, #fce8ef, #f9d2de);
            border: 2px solid #ba184a;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 16px rgba(186, 24, 74, 0.3);
            display: none;
        }

        .games-title {
            color: #ba184a;
            font-size: 1.3rem;
            font-weight: bold;
            text-align: center;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .game-card {
            background: white;
            border: 2px solid #e5346c;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 0;
        }

        .game-original {
            background: linear-gradient(135deg, #f6bbce, #f3a5be);
            border: 2px solid #ba184a;
        }

        .game-adjusted {
            background: linear-gradient(135deg, #fce8ef, #f9d2de);
            border: 2px solid #e5346c;
        }

        .game-type-badge {
            background: var(--primary-color);
            color: white;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-left: 10px;
        }

        .digits-info {
            background: var(--accent-color);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: bold;
            margin-top: 5px;
            display: inline-block;
        }

        .result-premio-info {
            margin-top: 15px;
            padding: 10px;
            background: linear-gradient(135deg, #f9d2de, #fce8ef);
            border-radius: 8px;
            border: 1px solid #e5346c;
        }

        .premio-item {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
            font-size: 0.8rem;
        }

        .premio-valor {
            font-weight: bold;
            color: var(--primary-dark);
        }

        .result-estimado {
            text-align: center;
            margin-top: 10px;
            padding: 8px;
            background: var(--secondary-color);
            color: white;
            border-radius: 15px;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .game-header {
            color: var(--primary-dark);
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
        }

        .game-numbers {
            text-align: center;
            margin: 10px 0;
        }

        .dezena-jogo {
            display: inline-block;
            width: 35px;
            height: 35px;
            line-height: 35px;
            text-align: center;
            background-color: var(--secondary-color);
            color: white;
            border-radius: 50%;
            margin: 0 3px;
            font-size: 0.9rem;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(186, 24, 74, 0.3);
        }

        .button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 24px;
            cursor: pointer;
            font-size: 1rem;
            margin: 10px;
            display: inline-block;
            border-radius: 8px;
            text-align: center;
            transition: all 0.3s ease;
            font-weight: 600;
            box-shadow: 0 3px 6px rgba(186, 24, 74, 0.3);
        }

        .button:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(186, 24, 74, 0.4);
        }

        .button:active {
            transform: translateY(0);
        }

        .button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .download-buttons {
            margin: 30px 0;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }

        footer {
            margin-top: auto;
            padding: 20px;
            text-align: center;
            background-color: var(--primary-color);
            color: white;
            width: 100%;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .tooltip {
            position: relative;
            display: inline-block;
            margin-left: 5px;
            cursor: help;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 250px;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 99999;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-bottom: 10px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.85rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            border: 2px solid #ba184a;
        }

        .tooltip .tooltiptext::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #555 transparent transparent transparent;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        .loading {
            text-align: center;
            margin: 20px 0;
            color: var(--primary-dark);
            font-size: 1.1rem;
            font-weight: bold;
            padding: 20px;
            background-color: var(--table-even);
            border-radius: 8px;
            border: 2px solid var(--primary-color);
            display: none;
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(186, 24, 74, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s ease-in-out infinite;
        }
		
		img {
			  display: block;
			  margin: auto;
			  width:200px;
			  height:100px;
			  opacity: 0.5;
			}
		img:hover {
				opacity: 1.0;
		}
		
        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Responsividade */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            h1 {
                font-size: 1.8rem;
            }

            .logo {
                width: 280px;
            }

            .numbers-grid {
                grid-template-columns: repeat(6, 1fr);
                max-width: 100%;
            }

            .number-btn {
                width: 45px;
                height: 45px;
                font-size: 0.9rem;
            }

            .config-grid {
                grid-template-columns: 1fr;
            }

            .results-grid {
                grid-template-columns: 1fr;
            }

            .dezena-resultado,
            .dezena-jogo {
                width: 30px;
                height: 30px;
                line-height: 30px;
                font-size: 0.8rem;
                margin: 0 2px;
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 1.5rem;
            }
            
            .logo {
                width: 220px;
            }

            .numbers-grid {
                grid-template-columns: repeat(5, 1fr);
            }

            .number-btn {
                width: 40px;
                height: 40px;
                font-size: 0.85rem;
            }
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
<div class="container">
    <div class="header">
        <img src="https://i.postimg.cc/hPDHjbJz/dupla-sena.jpg" alt="Dupla Sena Logo" class="logo">
        <h1>Gerador de Jogos da Dupla Sena</h1>
    </div>
    
    <div class="centralizado">
        <p>Crie seus jogos personalizados da <strong>Dupla Sena</strong> com ajustes inteligentes</p>
        <p><small>Escolha seus n√∫meros ‚Ä¢ Configure os ajustes ‚Ä¢ Gere quantos jogos quiser</small></p>
    </div>

    <!-- Loading dos √öltimos Resultados -->
    <div id="loadingResults" class="loading">
        <div class="loading-spinner"></div> Carregando √∫ltimos resultados...
    </div>

    <!-- Se√ß√£o dos √öltimos Resultados -->
    <div class="latest-results-section" id="latestResultsSection" style="display: none;">
        <div class="latest-results-title">
            <i class="fas fa-trophy"></i> √öltimos 6 Concursos da Dupla Sena
        </div>
        <div class="results-grid" id="resultsGrid">
            <!-- Resultados ser√£o inseridos aqui -->
        </div>
    </div>

    <!-- Se√ß√£o de Sele√ß√£o de N√∫meros -->
    <div class="number-selection-section">
        <div class="selection-title">
            <i class="fas fa-mouse-pointer"></i> Escolha seus 6 N√∫meros da Sorte
        </div>
        <div class="selection-info">
            <p><strong>Selecione exatamente 6 n√∫meros de 01 a 50</strong></p>
            <p id="selectedCount">Selecionados: <span>0</span>/6</p>
        </div>
        <div class="numbers-grid" id="numbersGrid">
            <!-- N√∫meros ser√£o gerados via JavaScript -->
        </div>
		<div align="center">
			<span><small>A Dupla Sena tem dois sorteios por concurso. Seu jogo concorre nos dois!</small></span>
		</div>
        <div class="selection-controls">
            <button class="button" onclick="clearSelection()">
                <i class="fas fa-eraser"></i> Limpar Sele√ß√£o
            </button>
            <button class="button" onclick="randomSelection()">
                <i class="fas fa-dice"></i> Sele√ß√£o Aleat√≥ria
            </button>
        </div>
    </div>

    <!-- Configura√ß√µes de Gera√ß√£o -->
    <div class="generation-section">
        <div class="generation-title">
            <i class="fas fa-cogs"></i> Configura√ß√µes dos Jogos
        </div>
        <div class="config-grid">
            <div class="config-item">
                <label>Jogos:</label>
                <input type="number" id="qtdJogos" min="1" value="8" onchange="updateTotalValue()">
                <span class="tooltip"><i class="fas fa-info-circle"></i>
                    <span class="tooltiptext">N√∫mero de jogos diferentes que ser√£o gerados</span>
                </span>
            </div>
            
            <div class="config-item">
                <label>Ajustes:</label>
                <select id="ajusteDezenas">
                    <option value="0">Sem Ajuste (0)</option>
                    <option value="1" selected>+ 1</option>
                    <option value="2">+ 2</option>
                    <option value="3">+ 3</option>
                    <option value="4">+ 4</option>
                    <option value="5">+ 5</option>
                    <option value="6">+ 6</option>
                    <option value="7">+ 7</option>
                    <option value="8">+ 8</option>
                    <option value="9">+ 9</option>
                    <option value="-1">- 1</option>
                    <option value="-2">- 2</option>
                    <option value="-3">- 3</option>
                    <option value="-4">- 4</option>
                    <option value="-5">- 5</option>
                    <option value="-6">- 6</option>
                    <option value="-7">- 7</option>
                    <option value="-8">- 8</option>
                    <option value="-9">- 9</option>
                </select>
                <span class="tooltip"><i class="fas fa-info-circle"></i>
                    <span class="tooltiptext">Valor que ser√° somado/subtra√≠do de cada n√∫mero (at√© ¬±9)</span>
                </span>
            </div>

			<div class="config-item">
				<label>Custo:</label>
				<select id="valorJogo" onchange="updateTotalValue()">
					<option value="3.00" selected>6 ‚Üí R$ 3,00</option>
					<option value="21.00">7 ‚Üí R$ 21,00</option>
					<option value="84.00">8 ‚Üí R$ 84,00</option>
					<option value="252.00">9 ‚Üí R$ 252,00</option>
					<option value="630.00">10 ‚Üí R$ 630,00</option>
					<option value="1386.00">11 ‚Üí R$ 1.386,00</option>
					<option value="2772.00">12 ‚Üí R$ 2.772,00</option>
					<option value="5148.00">13 ‚Üí R$ 5.148,00</option>
					<option value="9009.00">14 ‚Üí R$ 9.009,00</option>
					<option value="15015.00">15 ‚Üí R$ 15.015,00</option>
				</select>
				<span class="tooltip"><i class="fas fa-info-circle"></i>
					<span class="tooltiptext">Valor de cada jogo conforme a quantidade de n√∫meros escolhidos</span>
				</span>
			</div>

            <div class="config-item">
                <label>N√£o a Repeti√ß√£o:</label>
                <div style="display: flex; align-items: center; justify-content: center; margin-top: 10px;">
                    <input type="checkbox" id="evitarUltimoConcurso" style="width: auto; margin-right: 10px; transform: scale(1.5);">
                    <label for="evitarUltimoConcurso" style="margin: 0; font-size: 0.9rem; text-transform: none;"><span><small>√ë dez. √∫ltimo concurso</small></span></label>
                </div>
                <span class="tooltip"><i class="fas fa-info-circle"></i>
                    <span class="tooltiptext">Quando marcado, evita usar as dezenas que sa√≠ram no √∫ltimo concurso</span>
                </span>
            </div>
        </div>
        
        <div style="text-align: center;">
            <div id="totalValueDisplay" style="background: white; border: 2px solid #e5346c; border-radius: 8px; padding: 15px; margin-bottom: 15px; color: #5a0c25; font-weight: bold;">
                <i class="fas fa-calculator"></i> Total: R$ 27,00 (9 jogos √ó R$ 3,00)
            </div>
            <div id="digitsInfo" style="background: linear-gradient(135deg, #cb1a52, #ba184a); color: white; border-radius: 8px; padding: 10px; margin-bottom: 15px; font-weight: bold; text-align: center; display: none;">
                <i class="fas fa-chart-bar"></i> <span id="digitsText">Aguardando sele√ß√£o...</span>
            </div>
            <button class="button" onclick="generateGames()" id="generateBtn">
                <i class="fas fa-magic"></i> Gerar Jogos
            </button>
            <button class="button" onclick="showInfoModal()" style="background: #3498db; margin-left: 10px;">
                <i class="fas fa-info-circle"></i> Como Funciona
            </button>
        </div>
    </div>

    <!-- Se√ß√£o dos Jogos Gerados -->
    <div class="games-section" id="gamesSection">
        <div class="games-title">
            <i class="fas fa-list-ol"></i> Seus Jogos Gerados
        </div>
        <div id="gamesContainer">
            <!-- Jogos ser√£o inseridos aqui -->
        </div>
        
        <!-- Bot√µes de Download -->
        <div class="download-buttons">
            <button class="button" onclick="downloadTXT()">
                <i class="fas fa-file-alt"></i> Baixar TXT
            </button>
            <button class="button" onclick="downloadHTML()">
                <i class="fas fa-file-code"></i> Baixar HTML
            </button>
            <button class="button" onclick="downloadXLSX()">
                <i class="fas fa-file-excel"></i> Baixar XLSX
            </button>
        </div>
    </div>
</div>

<footer>
    <div>Feito por: <i>M√°rcio Fernando Maia - Todos os direitos reservados - 2025</i></div>
</footer>

<script>
let selectedNumbers = [];
let generatedGames = [];
let latestResults = [];

// Configura√ß√£o da API
const API_CONFIG = {
    CAIXA_URL: 'https://servicebus2.caixa.gov.br/portaldeloterias/api/duplasena',
    CORS_PROXY_URLS: [
        'https://api.allorigins.win/get?url=',
        'https://corsproxy.io/?'
    ]
};

// =================== INICIALIZA√á√ÉO ===================

window.addEventListener('load', () => {
    console.log('Gerador de Jogos da Dupla Sena carregado!');
    
    // Gerar grid de n√∫meros
    generateNumbersGrid();
    
    // Carregar √∫ltimos resultados
    loadLatestResults();
});

// =================== GRID DE N√öMEROS ===================

function generateNumbersGrid() {
    const grid = document.getElementById('numbersGrid');
    
    for (let i = 1; i <= 50; i++) {
        const btn = document.createElement('button');
        btn.className = 'number-btn';
        btn.textContent = i.toString().padStart(2, '0');
        btn.onclick = () => toggleNumber(i, btn);
        grid.appendChild(btn);
    }
}

function toggleNumber(number, btn) {
    const index = selectedNumbers.indexOf(number);
    
    if (index === -1) {
        // Adicionar n√∫mero
        if (selectedNumbers.length < 6) {
            selectedNumbers.push(number);
            btn.classList.add('selected');
        } else {
            showNotification('‚ùå Voc√™ s√≥ pode selecionar 6 n√∫meros!', 'error');
        }
    } else {
        // Remover n√∫mero
        selectedNumbers.splice(index, 1);
        btn.classList.remove('selected');
    }
    
    updateSelectedCount();
    updateGenerateButton();
    updateDigitsInfo();
    updateTotalValue();
}

function updateSelectedCount() {
    const countSpan = document.querySelector('#selectedCount span');
    countSpan.textContent = selectedNumbers.length;
}

function updateGenerateButton() {
    const btn = document.getElementById('generateBtn');
    btn.disabled = selectedNumbers.length !== 6;
}

function updateDigitsInfo() {
    const digitsDiv = document.getElementById('digitsInfo');
    const digitsText = document.getElementById('digitsText');
    
    if (selectedNumbers.length > 0) {
        const digits = selectedNumbers.map(n => n.toString().slice(-1));
        const digitCount = {};
        
        digits.forEach(d => {
            digitCount[d] = (digitCount[d] || 0) + 1;
        });
        
        const digitInfo = Object.entries(digitCount)
            .map(([digit, count]) => `${digit}(${count}x)`)
            .join(' ');
        
        digitsText.textContent = `D√≠gitos finais: ${digitInfo}`;
        digitsDiv.style.display = 'block';
    } else {
        digitsDiv.style.display = 'none';
    }
}

function updateTotalValue() {
    const qtdJogos = parseInt(document.getElementById('qtdJogos').value) || 8;
    const ajuste = parseInt(document.getElementById('ajusteDezenas').value);
    const valorJogo = parseFloat(document.getElementById('valorJogo').value);
    
    // Se sem ajuste, s√≥ o jogo original. Com ajuste, original + ajustados
    const totalJogos = ajuste === 0 ? 1 : qtdJogos + 1; // 1 original + N ajustados
    const total = (totalJogos * valorJogo).toFixed(2);
    
    const totalDisplay = document.getElementById('totalValueDisplay');
    totalDisplay.innerHTML = `<i class="fas fa-calculator"></i> Total: R$ ${total.replace('.', ',')} (${totalJogos} jogos √ó R$ ${valorJogo.toFixed(2).replace('.', ',')})`;
}

function clearSelection() {
    selectedNumbers = [];
    document.querySelectorAll('.number-btn').forEach(btn => {
        btn.classList.remove('selected');
    });
    updateSelectedCount();
    updateGenerateButton();
    updateDigitsInfo();
    showNotification('üßπ Sele√ß√£o limpa!', 'info');
}

function randomSelection() {
    clearSelection();
    
    while (selectedNumbers.length < 6) {
        const num = Math.floor(Math.random() * 50) + 1;
        if (!selectedNumbers.includes(num)) {
            selectedNumbers.push(num);
            const btn = document.querySelector(`.number-btn:nth-child(${num})`);
            btn.classList.add('selected');
        }
    }
    
    updateSelectedCount();
    updateGenerateButton();
    updateDigitsInfo();
    showNotification('üé≤ N√∫meros selecionados aleatoriamente!', 'success');
}

// =================== √öLTIMOS RESULTADOS ===================

async function loadLatestResults() {
    const loadingDiv = document.getElementById('loadingResults');
    const resultsSection = document.getElementById('latestResultsSection');
    
    loadingDiv.style.display = 'block';
    
    try {
        console.log('Carregando √∫ltimos resultados...');
        
        // Tentar buscar √∫ltimos 6 resultados
        const results = await fetchLatestResults();
        latestResults = results;
        
        displayLatestResults(results);
        
        loadingDiv.style.display = 'none';
        resultsSection.style.display = 'block';
        
    } catch (error) {
        console.error('Erro ao carregar resultados:', error);
        loadingDiv.style.display = 'none';
        
        // Mostrar resultados fict√≠cios em caso de erro
        const mockResults = generateMockResults();
        latestResults = mockResults;
        displayLatestResults(mockResults);
        resultsSection.style.display = 'block';
        
        showNotification('‚ö†Ô∏è Usando dados simulados (API indispon√≠vel)', 'info');
    }
}

async function fetchLatestResults() {
    // Tentar descobrir √∫ltimo concurso
    let ultimoConcurso = 2842; // fallback
    
    for (const proxyUrl of API_CONFIG.CORS_PROXY_URLS) {
        try {
            let url = `${proxyUrl}${encodeURIComponent(API_CONFIG.CAIXA_URL)}`;
            const response = await fetch(url);
            
            if (response.ok) {
                const proxyData = await response.json();
                const data = JSON.parse(proxyData.contents);
                if (data.numero) {
                    ultimoConcurso = parseInt(data.numero);
                    break;
                }
            }
        } catch (error) {
            console.warn(`Proxy ${proxyUrl} falhou:`, error);
        }
    }
    
    // Buscar os √∫ltimos 6 concursos
    const results = [];
    for (let i = 0; i < 6; i++) {
        const concursoNum = ultimoConcurso - i;
        const result = await fetchSingleResult(concursoNum);
        if (result) results.push(result);
    }
    
    return results;
}

async function fetchSingleResult(concursoNum) {
    for (const proxyUrl of API_CONFIG.CORS_PROXY_URLS) {
        try {
            const caixaUrl = `${API_CONFIG.CAIXA_URL}/${concursoNum}`;
            let url = `${proxyUrl}${encodeURIComponent(caixaUrl)}`;
            
            const response = await fetch(url);
            if (response.ok) {
                const proxyData = await response.json();
                const data = JSON.parse(proxyData.contents);
                
                if (data.numero && data.listaDezenas && data.listaDezenasSegundoSorteio) {
                    return {
                        concurso: data.numero,
                        data: formatDate(data.dataApuracao || new Date().toISOString()),
                        primeiroSorteio: data.listaDezenas,
                        segundoSorteio: data.listaDezenasSegundoSorteio,
                        acumulado: data.acumulado || false,
                        proximoConcurso: data.numeroConcursoProximo,
                        dataProximoConcurso: data.dataProximoConcurso,
                        valorEstimadoProximo: data.valorEstimadoProximoConcurso,
                        premiacoes: data.listaRateioPremio || [],
                        local: data.localSorteio || 'ESPA√áO DA SORTE',
                        cidade: data.nomeMunicipioUFSorteio || 'S√ÉO PAULO, SP'
                    };
                }
            }
        } catch (error) {
            console.warn(`Erro ao buscar concurso ${concursoNum}:`, error);
        }
    }
    
    return null;
}

function generateMockResults() {
    const results = [];
    
    for (let i = 0; i < 6; i++) {
        const concurso = 2842 - i;
        const date = new Date();
        date.setDate(date.getDate() - (i * 3));
        
        // Gerar primeiro sorteio
        const primeiroSorteio = [];
        while (primeiroSorteio.length < 6) {
            const num = Math.floor(Math.random() * 50) + 1;
            if (!primeiroSorteio.includes(num)) {
                primeiroSorteio.push(num);
            }
        }
        primeiroSorteio.sort((a, b) => a - b);
        
        // Gerar segundo sorteio
        const segundoSorteio = [];
        while (segundoSorteio.length < 6) {
            const num = Math.floor(Math.random() * 50) + 1;
            if (!segundoSorteio.includes(num)) {
                segundoSorteio.push(num);
            }
        }
        segundoSorteio.sort((a, b) => a - b);
        
        results.push({
            concurso: concurso,
            data: formatDate(date.toISOString()),
            primeiroSorteio: primeiroSorteio.map(n => n.toString().padStart(2, '0')),
            segundoSorteio: segundoSorteio.map(n => n.toString().padStart(2, '0'))
        });
    }
    
    return results;
}

function displayLatestResults(results) {
    const grid = document.getElementById('resultsGrid');
    grid.innerHTML = '';
    
    results.forEach((result, index) => {
        const card = document.createElement('div');
        card.className = `result-card ${index === 0 ? 'destaque' : ''}`;
        
        // Determinar status do concurso
        const statusConcurso = result.acumulado ? 'ACUMULOU!' : (result.premiacoes && result.premiacoes[0] && result.premiacoes[0].numeroDeGanhadores > 0 ? `${result.premiacoes[0].numeroDeGanhadores} GANHADORES` : 'ACUMULOU!');
        
        // Informa√ß√µes de premia√ß√£o
        let premiacaoInfo = '';
        if (result.premiacoes && result.premiacoes.length > 0) {
            // Agrupar por primeiro e segundo sorteio
            const primeiroSorteio = result.premiacoes.slice(0, 4);
            const segundoSorteio = result.premiacoes.slice(4, 8);
            
            premiacaoInfo = `
                <div style="margin-top: 15px;">
                    <div style="font-weight: bold; color: #ba184a; margin-bottom: 5px;">1¬∫ Sorteio:</div>
                    ${primeiroSorteio.map(p => 
                        `<div class="premio-item">
                            <span>${p.descricaoFaixa}:</span>
                            <span class="premio-valor">${p.numeroDeGanhadores} - R$ ${p.valorPremio.toFixed(2).replace('.', ',')}</span>
                        </div>`
                    ).join('')}
                    <div style="font-weight: bold; color: #ba184a; margin: 10px 0 5px 0;">2¬∫ Sorteio:</div>
                    ${segundoSorteio.map(p => 
                        `<div class="premio-item">
                            <span>${p.descricaoFaixa}:</span>
                            <span class="premio-valor">${p.numeroDeGanhadores} - R$ ${p.valorPremio.toFixed(2).replace('.', ',')}</span>
                        </div>`
                    ).join('')}
                </div>
            `;
        }
        
        // Pr√≥ximo concurso e valor estimado
        const proximoConcurso = result.proximoConcurso ? `Concurso ${result.proximoConcurso}` : 'A definir';
        const dataProximo = result.dataProximoConcurso ? formatDate(result.dataProximoConcurso) : 'A definir';
        const valorEstimado = result.valorEstimadoProximo ? `R$ ${(result.valorEstimadoProximo / 1000).toFixed(0)}.000,00` : 'A definir';
        
        card.innerHTML = `
            <div class="result-header">
                ${index === 0 ? 'üèÜ ' : ''}Concurso ${result.concurso}
            </div>
            <div class="result-date">
                <i class="fas fa-calendar"></i> ${result.data} ${result.cidade ? `(${result.cidade.split(',')[1] || result.cidade})` : ''}
            </div>
            
            <div class="sorteio-label">1¬∫ Sorteio</div>
            <div class="result-numbers">
                ${result.primeiroSorteio.map(num => 
                    `<span class="dezena-resultado">${num}</span>`
                ).join('')}
            </div>
            
            <div class="sorteio-label">2¬∫ Sorteio</div>
            <div class="result-numbers">
                ${result.segundoSorteio.map(num => 
                    `<span class="dezena-resultado">${num}</span>`
                ).join('')}
            </div>
            
            <div style="color: ${result.acumulado ? '#e74c3c' : '#27ae60'}; font-weight: bold; margin: 10px 0; font-size: 0.9rem;">
                ${statusConcurso}
            </div>
            
            ${premiacaoInfo ? `<div class="result-premio-info">${premiacaoInfo}</div>` : ''}
            
            <div class="result-estimado">
                Pr√≥ximo Sorteio: ${proximoConcurso}<br>
                ${dataProximo}<br>
                Pr√™mio Estimado: <strong>${valorEstimado}</strong>
            </div>
            
            <div>
                <button class="use-result-btn" onclick="useResult(${index}, 1)">
                    <i class="fas fa-magic"></i> Usar 1¬∫ Sorteio
                </button>
                <button class="use-result-btn" onclick="useResult(${index}, 2)">
                    <i class="fas fa-magic"></i> Usar 2¬∫ Sorteio
                </button>
            </div>
        `;
        
        grid.appendChild(card);
    });
    
    // Destacar n√∫meros do √∫ltimo concurso na grade de sele√ß√£o
    if (results.length > 0) {
        const allNumbers = [...results[0].primeiroSorteio, ...results[0].segundoSorteio];
        highlightLastConcursoNumbers(allNumbers);
    }
}

function highlightLastConcursoNumbers(lastConcursoDezenas) {
    // Limpar destaques anteriores
    document.querySelectorAll('.number-btn').forEach(btn => {
        btn.classList.remove('last-result');
    });
    
    // Destacar n√∫meros do √∫ltimo concurso
    lastConcursoDezenas.forEach(dezena => {
        const numero = parseInt(dezena);
        const btn = document.querySelector(`.number-btn:nth-child(${numero})`);
        if (btn) {
            btn.classList.add('last-result');
        }
    });
    
    // Adicionar informa√ß√£o visual
    const selectionInfo = document.querySelector('.selection-info');
    if (selectionInfo && lastConcursoDezenas.length > 0) {
        const lastResultInfo = document.createElement('p');
        lastResultInfo.id = 'lastResultInfo';
        lastResultInfo.innerHTML = `<strong style="color: #e74c3c;">üî¥ N√∫meros em destaque sa√≠ram no √∫ltimo concurso</strong>`;
        lastResultInfo.style.marginTop = '10px';
        selectionInfo.appendChild(lastResultInfo);
    }
}

function useResult(index, sorteio) {
    const result = latestResults[index];
    if (!result) return;
    
    // Limpar sele√ß√£o atual
    clearSelection();
    
    // Selecionar n√∫meros do resultado (1¬∫ ou 2¬∫ sorteio)
    const numeros = sorteio === 1 ? 
        result.primeiroSorteio.map(n => parseInt(n)) : 
        result.segundoSorteio.map(n => parseInt(n));
        
    numeros.forEach(num => {
        selectedNumbers.push(num);
        const btn = document.querySelector(`.number-btn:nth-child(${num})`);
        if (btn) btn.classList.add('selected');
    });
    
    updateSelectedCount();
    updateGenerateButton();
    updateDigitsInfo();
    updateTotalValue();
    showNotification(`‚úÖ N√∫meros do ${sorteio}¬∫ sorteio do concurso ${result.concurso} selecionados!`, 'success');
}

// =================== GERA√á√ÉO DE JOGOS ===================

async function generateGames() {
    if (selectedNumbers.length !== 6) {
        showNotification('‚ùå Selecione exatamente 6 n√∫meros!', 'error');
        return;
    }
    
    const qtdJogos = parseInt(document.getElementById('qtdJogos').value);
    const ajusteBase = parseInt(document.getElementById('ajusteDezenas').value);
    const evitarUltimoConcurso = document.getElementById('evitarUltimoConcurso').checked;
    
    if (qtdJogos < 1) {
        showNotification('‚ùå Quantidade de jogos deve ser no m√≠nimo 1!', 'error');
        return;
    }
    
    // Aviso para grandes quantidades
    if (qtdJogos > 1000) {
        const confirmed = await showConfirmDialog(
            `‚ö†Ô∏è Voc√™ est√° prestes a gerar ${qtdJogos.toLocaleString()} jogos!\n\n` +
            `Isso pode:\n` +
            `‚Ä¢ Demorar alguns segundos para processar\n` +
            `‚Ä¢ Consumir mais mem√≥ria do navegador\n` +
            `‚Ä¢ Gerar arquivos grandes para download\n\n` +
            `Deseja continuar?`
        );
        
        if (!confirmed) {
            return;
        }
    }
    
    // Obter dezenas do √∫ltimo concurso para evitar
    let dezenasEvitar = [];
    if (evitarUltimoConcurso && latestResults.length > 0) {
        const ultimo = latestResults[0];
        dezenasEvitar = [...ultimo.primeiroSorteio, ...ultimo.segundoSorteio].map(d => parseInt(d));
    }
    
    generatedGames = [];
    let jogoCounter = 1;
    
    // Verificar se n√∫meros selecionados coincidem com √∫ltimo concurso
    if (evitarUltimoConcurso && dezenasEvitar.length > 0) {
        const conflict = selectedNumbers.some(num => dezenasEvitar.includes(num));
        if (conflict) {
            showNotification('‚ö†Ô∏è Alguns n√∫meros selecionados sa√≠ram no √∫ltimo concurso!', 'info');
        }
    }
    
    // Adicionar jogo original apenas UMA VEZ
    const originalNumbers = [...selectedNumbers].sort((a, b) => a - b);
    generatedGames.push({
        jogo: jogoCounter++,
        tipo: 'original',
        numeros: originalNumbers.map(n => n.toString().padStart(2, '0'))
    });
    
    // Gerar jogos ajustados com ajuste progressivo
    if (ajusteBase !== 0) {
        for (let i = 1; i <= qtdJogos; i++) {
            // Calcular ajuste progressivo
            const ajusteAtual = ajusteBase * i;
            
            // Aplicar ajuste progressivo
            let gameNumbers = selectedNumbers.map(num => {
                let adjusted = num + ajusteAtual;
                
                // Manter entre 1 e 50 (limites da Dupla Sena)
                if (adjusted < 1) adjusted = 1;
                if (adjusted > 50) adjusted = 50;
                
                return adjusted;
            });
            
            // Evitar dezenas do √∫ltimo concurso se checkbox estiver marcado
            if (evitarUltimoConcurso && dezenasEvitar.length > 0) {
                gameNumbers = gameNumbers.map(num => {
                    let tentativas = 0;
                    while (dezenasEvitar.includes(num) && tentativas < 10) {
                        // Tentar um n√∫mero alternativo pr√≥ximo
                        const alternativas = [num + 1, num - 1, num + 2, num - 2];
                        for (const alt of alternativas) {
                            if (alt >= 1 && alt <= 50 && !dezenasEvitar.includes(alt) && !gameNumbers.includes(alt)) {
                                num = alt;
                                break;
                            }
                        }
                        tentativas++;
                    }
                    return num;
                });
            }
            
            gameNumbers.sort((a, b) => a - b);
            
            generatedGames.push({
                jogo: jogoCounter++,
                tipo: 'ajustado',
                ajuste: ajusteAtual,
                numeros: gameNumbers.map(n => n.toString().padStart(2, '0'))
            });
        }
    }
    
    displayGeneratedGamesOptimized();
    
    let successMessage = `‚úÖ ${generatedGames.length} jogos gerados com sucesso!`;
    if (evitarUltimoConcurso && dezenasEvitar.length > 0) {
        successMessage += ' (Evitando repeti√ß√µes do √∫ltimo concurso)';
    }
    
    showNotification(successMessage, 'success');
}

// =================== DOWNLOADS ===================

function downloadTXT() {
    if (generatedGames.length === 0) {
        showNotification('‚ùå Nenhum jogo foi gerado ainda!', 'error');
        return;
    }
    
    // Formato simplificado - APENAS AS DEZENAS separadas por espa√ßos
    let content = "";
    
    generatedGames.forEach(game => {
        content += `${game.numeros.join(' ')}\n`;
    });
    
    downloadFile(content, 'jogos_dupla_sena.txt', 'text/plain');
    showNotification('üìÑ Arquivo TXT baixado! (apenas dezenas)', 'success');
}

function downloadHTML() {
    if (generatedGames.length === 0) {
        showNotification('‚ùå Nenhum jogo foi gerado ainda!', 'error');
        return;
    }
    
    let html = `
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meus Jogos da Dupla Sena</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #fce8ef, #f9d2de);
            margin: 0;
            padding: 20px;
            color: #2d0612;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            color: #9e1540;
        }
        .info {
            text-align: center;
            margin-bottom: 30px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #ba184a;
        }
        .game {
            background: white;
            margin: 15px 0;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e5346c;
            text-align: center;
        }
        .game-title {
            font-weight: bold;
            color: #9e1540;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        .numbers {
            margin: 15px 0;
        }
        .number {
            display: inline-block;
            width: 40px;
            height: 40px;
            line-height: 40px;
            background: #ba184a;
            color: white;
            border-radius: 50%;
            margin: 0 5px;
            font-weight: bold;
        }
        .footer {
            text-align: center;
            margin-top: 30px;
            color: #5a0c25;
            font-style: italic;
        }
        @media print {
            body { background: white; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üéØ MEUS JOGOS DA DUPLA SENA üéØ</h1>
    </div>
    
    <div class="info">
        <p><strong>Data de Gera√ß√£o:</strong> ${new Date().toLocaleString('pt-BR')}</p>
        <p><strong>Total de Jogos:</strong> ${generatedGames.length}</p>
    </div>
    
    ${generatedGames.map(game => `
        <div class="game">
            <div class="game-title">üé´ Jogo ${game.jogo}</div>
            <div class="numbers">
                ${game.numeros.map(num => `<span class="number">${num}</span>`).join('')}
            </div>
        </div>
    `).join('')}
    
    <div class="footer">
        <p>Gerado por: <strong>Gerador de Jogos da Dupla Sena</strong></p>
        <p>üéØ Boa sorte em todos os sorteios! üéØ</p>
    </div>
</body>
</html>`;
    
    downloadFile(html, 'jogos_dupla_sena.html', 'text/html');
    showNotification('üåê Arquivo HTML baixado!', 'success');
}

function downloadXLSX() {
    if (generatedGames.length === 0) {
        showNotification('‚ùå Nenhum jogo foi gerado ainda!', 'error');
        return;
    }
    
    // Criar dados para a planilha
    const data = [
        ['JOGOS DA DUPLA SENA - GERADOS AUTOMATICAMENTE'],
        [`Data de Gera√ß√£o: ${new Date().toLocaleString('pt-BR')}`],
        [`Total de Jogos: ${generatedGames.length}`],
        [''], // linha vazia
        ['Jogo', 'N√∫mero 1', 'N√∫mero 2', 'N√∫mero 3', 'N√∫mero 4', 'N√∫mero 5', 'N√∫mero 6']
    ];
    
    generatedGames.forEach(game => {
        data.push([
            `Jogo ${game.jogo}`,
            ...game.numeros
        ]);
    });
    
    data.push(['']); // linha vazia
    data.push(['Gerado por: Gerador de Jogos da Dupla Sena']);
    data.push(['Boa sorte! üéØ']);
    
    // Criar workbook
    const wb = XLSX.utils.book_new();
    const ws = XLSX.utils.aoa_to_sheet(data);
    
    // Ajustar largura das colunas
    const colWidths = [
        {wch: 12}, // Jogo
        {wch: 10}, {wch: 10}, {wch: 10}, {wch: 10}, {wch: 10}, {wch: 10} // N√∫meros
    ];
    ws['!cols'] = colWidths;
    
    XLSX.utils.book_append_sheet(wb, ws, "Jogos Dupla Sena");
    
    // Baixar arquivo
    XLSX.writeFile(wb, 'jogos_dupla_sena.xlsx');
    showNotification('üìä Arquivo XLSX baixado!', 'success');
}

// =================== FUN√á√ïES AUXILIARES ===================

function downloadFile(content, fileName, mimeType) {
    const blob = new Blob([content], { type: mimeType });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = fileName;
    link.click();
    
    setTimeout(() => {
        URL.revokeObjectURL(link.href);
    }, 100);
}

function formatDate(dateString) {
    try {
        const date = new Date(dateString);
        return date.toLocaleDateString('pt-BR');
    } catch (error) {
        return new Date().toLocaleDateString('pt-BR');
    }
}

function showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: ${type === 'success' ? 'linear-gradient(135deg, #22c55e, #16a34a)' : 
                     type === 'error' ? 'linear-gradient(135deg, #ef4444, #dc2626)' : 
                     'linear-gradient(135deg, #ba184a, #e5346c)'};
        color: white;
        padding: 15px 20px;
        border-radius: 8px;
        box-shadow: 0 4px 16px rgba(0,0,0,0.2);
        z-index: 10000;
        font-weight: 600;
        animation: slideInRight 0.3s ease;
        max-width: 300px;
    `;
    notification.textContent = message;
    
    // Adicionar CSS da anima√ß√£o se n√£o existir
    if (!document.getElementById('notification-style')) {
        const style = document.createElement('style');
        style.id = 'notification-style';
        style.textContent = `
            @keyframes slideInRight {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
        `;
        document.head.appendChild(style);
    }
    
    document.body.appendChild(notification);
    
    // Remover ap√≥s 4 segundos
    setTimeout(() => {
        notification.remove();
    }, 4000);
}

// =================== FUN√á√ïES DE OTIMIZA√á√ÉO ===================

function showConfirmDialog(message) {
    return new Promise((resolve) => {
        const modal = document.createElement('div');
        modal.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 99999;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        `;
        
        const dialog = document.createElement('div');
        dialog.style.cssText = `
            background: white;
            padding: 30px;
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            border: 3px solid #ba184a;
        `;
        
        dialog.innerHTML = `
            <div style="text-align: center; margin-bottom: 25px;">
                <h3 style="color: #9e1540; margin-bottom: 15px; font-size: 1.4rem;">‚ö†Ô∏è Confirma√ß√£o Necess√°ria</h3>
                <p style="color: #2d0612; line-height: 1.6; white-space: pre-line; font-size: 1rem;">${message}</p>
            </div>
            <div style="display: flex; justify-content: center; gap: 15px;">
                <button id="cancelBtn" style="
                    background: #e74c3c;
                    color: white;
                    border: none;
                    padding: 12px 24px;
                    border-radius: 8px;
                    cursor: pointer;
                    font-size: 1rem;
                    font-weight: 600;
                    transition: all 0.3s ease;
                ">‚ùå Cancelar</button>
                <button id="confirmBtn" style="
                    background: #ba184a;
                    color: white;
                    border: none;
                    padding: 12px 24px;
                    border-radius: 8px;
                    cursor: pointer;
                    font-size: 1rem;
                    font-weight: 600;
                    transition: all 0.3s ease;
                ">‚úÖ Continuar</button>
            </div>
        `;
        
        modal.appendChild(dialog);
        document.body.appendChild(modal);
        
        // Adicionar eventos
        const cancelBtn = dialog.querySelector('#cancelBtn');
        const confirmBtn = dialog.querySelector('#confirmBtn');
        
        cancelBtn.addEventListener('click', () => {
            document.body.removeChild(modal);
            resolve(false);
        });
        
        confirmBtn.addEventListener('click', () => {
            document.body.removeChild(modal);
            resolve(true);
        });
        
        // Fechar com ESC
        const keyHandler = (e) => {
            if (e.key === 'Escape') {
                document.body.removeChild(modal);
                document.removeEventListener('keydown', keyHandler);
                resolve(false);
            }
        };
        document.addEventListener('keydown', keyHandler);
        
        // Hover effects
        cancelBtn.addEventListener('mouseenter', () => {
            cancelBtn.style.background = '#c0392b';
            cancelBtn.style.transform = 'translateY(-2px)';
        });
        cancelBtn.addEventListener('mouseleave', () => {
            cancelBtn.style.background = '#e74c3c';
            cancelBtn.style.transform = 'translateY(0)';
        });
        
        confirmBtn.addEventListener('mouseenter', () => {
            confirmBtn.style.background = '#9e1540';
            confirmBtn.style.transform = 'translateY(-2px)';
        });
        confirmBtn.addEventListener('mouseleave', () => {
            confirmBtn.style.background = '#ba184a';
            confirmBtn.style.transform = 'translateY(0)';
        });
    });
}

// Otimiza√ß√£o para grandes quantidades de jogos
function displayGeneratedGamesOptimized() {
    const container = document.getElementById('gamesContainer');
    const section = document.getElementById('gamesSection');
    
    // Para quantidades muito grandes, mostrar apenas estat√≠sticas
    if (generatedGames.length > 5000) {
        container.innerHTML = `
            <div style="text-align: center; padding: 40px; background: white; border-radius: 10px; border: 2px solid #ba184a; margin-bottom: 20px;">
                <h3 style="color: #9e1540; margin-bottom: 20px;">
                    üéÆ ${generatedGames.length.toLocaleString()} Jogos Gerados com Sucesso!
                </h3>
                <p style="color: #2d0612; margin-bottom: 15px; font-size: 1.1rem;">
                    <strong>Devido √† grande quantidade, os jogos n√£o s√£o exibidos na tela para otimizar a performance.</strong>
                </p>
                <p style="color: #5a0c25; margin-bottom: 20px;">
                    Use os bot√µes de download abaixo para obter seus jogos:
                </p>
                <div style="display: flex; justify-content: center; gap: 10px; flex-wrap: wrap;">
                    <span style="background: #ba184a; color: white; padding: 8px 15px; border-radius: 20px; font-weight: bold;">
                        üìÑ TXT: ${(generatedGames.length * 20 / 1024).toFixed(1)} KB
                    </span>
                    <span style="background: #e5346c; color: white; padding: 8px 15px; border-radius: 20px; font-weight: bold;">
                        üåê HTML: ${(generatedGames.length * 150 / 1024).toFixed(1)} KB
                    </span>
                    <span style="background: #cb1a52; color: white; padding: 8px 15px; border-radius: 20px; font-weight: bold;">
                        üìä XLSX: ${(generatedGames.length * 50 / 1024).toFixed(1)} KB
                    </span>
                </div>
            </div>
        `;
    } else if (generatedGames.length > 1000) {
        // Para quantidades m√©dias, mostrar apenas os primeiros 50 jogos
        container.innerHTML = `
            <div style="text-align: center; padding: 20px; background: #fce8ef; border-radius: 8px; border: 2px solid #e5346c; margin-bottom: 20px;">
                <p style="color: #9e1540; font-weight: bold; margin-bottom: 10px;">
                    üìä ${generatedGames.length.toLocaleString()} jogos gerados! Exibindo apenas os primeiros 50 para otimizar a performance.
                </p>
                <small style="color: #5a0c25;">Use os bot√µes de download para obter todos os jogos.</small>
            </div>
            <div class="games-grid" id="gamesGrid"></div>
        `;
        
        const gamesGrid = document.getElementById('gamesGrid');
        
        // Mostrar apenas os primeiros 50 jogos
        generatedGames.slice(0, 50).forEach(game => {
            const card = createGameCard(game);
            gamesGrid.appendChild(card);
        });
    } else {
        // Para quantidades normais, mostrar todos os jogos
        container.innerHTML = '<div class="games-grid" id="gamesGrid"></div>';
        const gamesGrid = document.getElementById('gamesGrid');
        
        generatedGames.forEach(game => {
            const card = createGameCard(game);
            gamesGrid.appendChild(card);
        });
    }
    
    section.style.display = 'block';
}

// Fun√ß√£o auxiliar para criar um card de jogo
function createGameCard(game) {
    const card = document.createElement('div');
    
    // Definir classe baseada no tipo
    if (game.tipo === 'original') {
        card.className = 'game-card game-original';
    } else {
        card.className = 'game-card game-adjusted';
    }
    
    // Criar badge do tipo
    let typeBadge = '';
    if (game.tipo === 'original') {
        typeBadge = '<span class="game-type-badge">üéØ ORIGINAL</span>';
    } else {
        const ajusteSymbol = game.ajuste > 0 ? '+' : '';
        typeBadge = `<span class="game-type-badge">üìà AJUSTADO (${ajusteSymbol}${game.ajuste})</span>`;
    }
    
    // Contar d√≠gitos √∫nicos usados
    const allDigits = game.numeros.flatMap(n => n.toString().split(''));
    const uniqueDigits = [...new Set(allDigits)];
    const digitCount = uniqueDigits.length;
    
    card.innerHTML = `
        <div class="game-header">
            <i class="fas fa-ticket-alt"></i> Jogo ${game.jogo}
            ${typeBadge}
        </div>
        <div class="game-numbers">
            ${game.numeros.map(num => 
                `<span class="dezena-jogo">${num}</span>`
            ).join('')}
        </div>
        <div style="text-align: center; margin-top: 5px;">
            <span class="digits-info">${digitCount}d</span>
        </div>
    `;
    
    return card;
}

// =================== MODAL DE INFORMA√á√ïES ===================

function showInfoModal() {
    const modal = document.createElement('div');
    modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 99999;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        overflow-y: auto;
        padding: 20px;
    `;
    
    const dialog = document.createElement('div');
    dialog.style.cssText = `
        background: white;
        border-radius: 15px;
        max-width: 800px;
        width: 95%;
        max-height: 90vh;
        overflow-y: auto;
        box-shadow: 0 15px 50px rgba(0,0,0,0.4);
        border: 3px solid #ba184a;
        position: relative;
    `;
    
    dialog.innerHTML = `
        <div style="background: linear-gradient(135deg, #ba184a, #e5346c); color: white; padding: 20px; border-radius: 12px 12px 0 0; text-align: center; position: relative;">
            <button id="closeModal" style="
                position: absolute;
                top: 15px;
                right: 20px;
                background: rgba(255,255,255,0.2);
                border: none;
                color: white;
                font-size: 1.5rem;
                cursor: pointer;
                border-radius: 50%;
                width: 35px;
                height: 35px;
                display: flex;
                align-items: center;
                justify-content: center;
                transition: all 0.3s ease;
            " onmouseover="this.style.background='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">√ó</button>
            <h2 style="margin: 0; font-size: 1.8rem;">
                <i class="fas fa-info-circle"></i> Como Funciona o Sistema
            </h2>
            <p style="margin: 10px 0 0 0; opacity: 0.9;">Otimizado para qualquer quantidade de jogos</p>
        </div>
        
        <div style="padding: 30px; line-height: 1.6;">
            
            <!-- Informa√ß√µes da Dupla Sena -->
            <div style="background: linear-gradient(135deg, #ba184a, #e5346c); color: white; padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                <h3 style="margin: 0 0 15px 0; font-size: 1.3rem;">
                    <i class="fas fa-star"></i> Caracter√≠sticas da Dupla Sena
                </h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-top: 15px;">
                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                        <strong>üéØ Dois Sorteios</strong><br>
                        <small>Cada jogo concorre em dois sorteios independentes</small>
                    </div>
                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                        <strong>üî¢ 6 N√∫meros</strong><br>
                        <small>Escolha 6 n√∫meros de 01 a 50</small>
                    </div>
                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                        <strong>üí∞ Premia√ß√£o Dupla</strong><br>
                        <small>Chances de ganhar no primeiro ou segundo sorteio</small>
                    </div>
                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                        <strong>üìÖ Sorteios</strong><br>
                        <small>Ter√ßas, quintas e s√°bados</small>
                    </div>
                </div>
            </div>
            
            <!-- Sistema de Otimiza√ß√£o -->
            <div style="background: linear-gradient(135deg, #3498db, #2980b9); color: white; padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                <h3 style="margin: 0 0 15px 0; font-size: 1.3rem;">
                    <i class="fas fa-rocket"></i> Sistema de Otimiza√ß√£o
                </h3>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 15px; margin-top: 15px;">
                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 2rem; margin-bottom: 10px;">üéÆ</div>
                        <strong>At√© 1.000 jogos</strong><br>
                        <small>‚Ä¢ Exibe todos os jogos normalmente<br>‚Ä¢ Performance otimizada<br>‚Ä¢ Interface completa</small>
                    </div>
                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 2rem; margin-bottom: 10px;">üéØ</div>
                        <strong>1.001 a 5.000 jogos</strong><br>
                        <small>‚Ä¢ Mostra apenas os primeiros 50<br>‚Ä¢ Aviso claro sobre limita√ß√£o<br>‚Ä¢ Performance preservada</small>
                    </div>
                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 2rem; margin-bottom: 10px;">üí∞</div>
                        <strong>Acima de 5.000 jogos</strong><br>
                        <small>‚Ä¢ N√£o exibe jogos na tela<br>‚Ä¢ Mostra estat√≠sticas<br>‚Ä¢ Performance m√°xima</small>
                    </div>
                </div>
            </div>
            
            <!-- Estrat√©gias -->
            <div style="background: linear-gradient(135deg, #27ae60, #229954); color: white; padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                <h3 style="margin: 0 0 15px 0; font-size: 1.3rem;">
                    <i class="fas fa-brain"></i> Estrat√©gias Inteligentes
                </h3>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin-top: 15px;">
                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                        <h4 style="margin: 0 0 10px 0;">üìä Baseado em Dados Reais:</h4>
                        <ul style="margin: 0; padding-left: 20px;">
                            <li>‚úÖ API oficial da Caixa</li>
                            <li>‚úÖ √öltimos 6 concursos</li>
                            <li>‚úÖ Ambos os sorteios</li>
                            <li>‚úÖ Estat√≠sticas atualizadas</li>
                        </ul>
                    </div>
                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                        <h4 style="margin: 0 0 10px 0;">üîß Ajustes Progressivos:</h4>
                        <ul style="margin: 0; padding-left: 20px;">
                            <li>‚úÖ Ajustes de ¬±1 a ¬±9</li>
                            <li>‚úÖ Progress√£o autom√°tica</li>
                            <li>‚úÖ Evita repeti√ß√µes</li>
                            <li>‚úÖ M√°xima diversidade</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- Downloads -->
            <div style="background: linear-gradient(135deg, #9b59b6, #8e44ad); color: white; padding: 20px; border-radius: 10px;">
                <h3 style="margin: 0 0 15px 0; font-size: 1.3rem;">
                    <i class="fas fa-download"></i> Formatos de Download
                </h3>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-top: 15px;">
                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                        <strong>üìÑ TXT</strong><br>
                        <small>Formato simples - apenas as dezenas separadas por espa√ßos</small>
                    </div>
                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                        <strong>üåê HTML</strong><br>
                        <small>P√°gina web completa para impress√£o e visualiza√ß√£o</small>
                    </div>
                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                        <strong>üìä XLSX</strong><br>
                        <small>Planilha do Excel para an√°lises avan√ßadas</small>
                    </div>
                </div>
            </div>
            
        </div>
        
        <div style="background: #f8f9fa; padding: 20px; border-radius: 0 0 12px 12px; text-align: center; border-top: 2px solid #e9ecef;">
            <button onclick="document.body.removeChild(this.closest('.fixed'))" style="
                background: linear-gradient(135deg, #ba184a, #e5346c);
                color: white;
                border: none;
                padding: 12px 30px;
                border-radius: 8px;
                cursor: pointer;
                font-size: 1.1rem;
                font-weight: 600;
                transition: all 0.3s ease;
            " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 5px 15px rgba(186,24,74,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                <i class="fas fa-check"></i> Entendi! Vamos Apostar
            </button>
            <p style="margin: 15px 0 0 0; color: #6c757d; font-size: 0.9rem;">
                <i class="fas fa-lightbulb"></i> Dupla chance de ganhar - dois sorteios por concurso!
            </p>
        </div>
    `;
    
    modal.appendChild(dialog);
    document.body.appendChild(modal);
    
    // Eventos para fechar o modal
    const closeBtn = dialog.querySelector('#closeModal');
    closeBtn.addEventListener('click', () => {
        document.body.removeChild(modal);
    });
    
    // Fechar clicando fora do modal
    modal.addEventListener('click', (e) => {
        if (e.target === modal) {
            document.body.removeChild(modal);
        }
    });
    
    // Fechar com ESC
    const keyHandler = (e) => {
        if (e.key === 'Escape') {
            document.body.removeChild(modal);
            document.removeEventListener('keydown', keyHandler);
        }
    };
    document.addEventListener('keydown', keyHandler);
}
</script>

</body>
</html>